#  数据库面试真题

##  一、什么是事务？

###  1.概念

* 数据库事务是访问并可能操作各种数据项的的一个数据库操作序列， 这些操作要么全部执行， 要么全部不执行， 是一个不可分割的工作单位。
* 事务是由事务是具备ACID特性的操作。是由DBMS来进行操作。
  * 原子性
    * 事务时为一个不可分割的最小单元， 事务全部操作要么全部完成，要么全部事败， 进行回滚操作 (回滚日志)
  * 一致性
    * 数据库在事务执行前后保持一致性状态， 在一致性装态下， 所有事物对同一个事务的读取结果一定是相同的
  * 隔离性
    * 一个事物在所做的修改进行最终的提交之前， 对于其他事物时不可见的， （并行）
  * 持久性
    * 一旦事务提交， 则其所做的修改，将永远保存在数据中， 即是数据崩溃， 也是不可以丢失的



##  二、内连接和外连接有什么区别

1.内连接也叫自然连接.

* 只有两个表行型匹配才会得到结果， 在结果集中显示出来

| A表   |      | B表   |      |
| ---- | ---- | ---- | ---- |
| id   | name | id   | name |
| 1    | a    | 1    | b    |
| 2    | b    | 3    | c    |
| 4    | c    |      |      |

*  内连接就是左表和右表相同的数据：

   * 查询语句select * from A inner join B on A.id=B.id
   * 结果

   | id   | name | id   | name |
   | ---- | ---- | ---- | ---- |
   | 1    | a    | 1    | b    |

2.外连接分为：左外连接、右外连接、全外连接

* 左外连接就是以左表为准，去匹配右表，左表有多少条数据，结果就是多少条数据

* 语句 select * from A left join B on A.id=B.id

* | id   | name | id   | name |
  | ---- | ---- | ---- | ---- |
  | 1    | a    | 1    | b    |
  | 2    | b    | null | null |
  | 4    | c    | null | null |

* 右外连接就是与左外连接反之，以右表为准，去匹配左表，右表有多少条数据，结果就是多

* 语句select * from A right join B on A.id=B.id

* | id   | name | id   | name |
  | ---- | ---- | ---- | ---- |
  | 1    | a    | 1    | b    |
  | null | null | 3    | c    |

* 全外连接数据条数不一定，相当与是左外连接和右外连接的综合

* select * from A full join B on A.id=B.id

* | id   | name | id   | name |
  | ---- | ---- | ---- | ---- |
  | 1    | a    | 1    | b    |
  | 2    | b    | null | null |
  | null | null | 3    | c    |
  | 4    | c    | null | null |

##  三. 存储过程和函数的区别

1.函数只能咋sql钓用

2.区别

* 1。存储过程一般是作为独立部分来执行，而函数可以作为查询语句的一个部分来调用
* 存储过程处理的功能比较复杂，而函数实现的功能针对性强，
* 函数只能返回一个值和对象  一般是在SQL语句中实现的，而存储过程可以返回多个 他是独立实现的；、
* 函数可以嵌入sql中和存储过程中使用，但是存储过程需要让sql的query可以执行，将mysql_real_connect的最后一个参数设置为CLIENT_MULTI_STATEMENTS
* 函数的限制比较多，不能用临时表，只能用表变量，有些函数不能用，存储过程限制少

##  四、什么是主键， 什么是外键

* 什么是主键
  * 是数据库表中一个或者多个字段， 是数据表中唯一的标示符
  * 主键应遵循以下原则
* 什么是外键
  * 又叫外码
  * 两个关系之间的联系， 他在一个关系中是主键， 在另一个关系中就是外键
  * 作用是和其他表中建立联系， 和其他表中进行关联， 保证数据一致性， 保证参照完整型
* 实体完整性
  * 数据表中必须有主键， 并且必须是唯一的， 非空值
    * 主键对于用户没有意义
    * 主键非空
    * 主键保持不变
    * 不包含动态的时间戳
    * 原则上计算机自动生成的， 一般不由用户更改
* 参照完整性
  * 要么是真实存在的， 要么是空值
* 用户自定义完整性

##  五、什么是死锁， 产生的原因是什么？如何避免？

1.定义

* 同时存在并发的进程和线程， 不断的申请和释放资源， 在某个过程中可能处于无限期间的等待状态， 造成无法继续执行， 在没有外力作用下一直保持

2.主要原因是

* 系统资源不足
* 进程推进顺序不合理
* 资源分配不等

3.产生死锁的四个必要条件

* 互斥
  * 某个资源只能被一个进程使用
* 请求和保持
  * 因为请求资源情况下， 对于已经获得资源进行保持
* 不可剥夺条件
* 环路等待

4.避免死锁

* 系统分配的最典型算法是银行家算法


* 预防死锁
* 避免死锁 
* 检测死锁 
* 解除死锁

##  六、什么是共享锁， 什么是互斥锁？

* 共享锁
  * 又称为读锁/s锁
  * 用于不更新数据的操作， 多个事务， 进行只读
  * 加了共享锁之后， 别人可以继续加共享锁， 但是不能加排他锁
* 排他锁
* 又叫写锁， 互斥锁， X锁
* 用来做数据的修改， 确保不会再同时对同一资源进行多重更新， 也不会在这个过程进行读操作













